{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/muhajirin95/bootcamp_arkademy_/blob/master/long%20to%20short\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 1,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "collapsed": true,
        "id": "bAXiFsClNGrb",
        "outputId": "6d2ef39c-e516-42b1-bf90-42f79c48cb3e"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Mounted at /content/drive\n"
          ]
        }
      ],
      "source": [
        "from google.colab import drive\n",
        "import os\n",
        "\n",
        "# Ensure the mount point is clear by forcefully removing it\n",
        "\n",
        "drive.mount('/content/drive', force_remount=True)\n",
        "\n",
        "DRIVE_PATH = '/content/drive/MyDrive/VideoProjects'"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 2,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "collapsed": true,
        "id": "QRVxtuGVNL2p",
        "outputId": "88a64ea1-863a-484f-b808-6977a3895ec2"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Requirement already satisfied: yt-dlp[all] in /usr/local/lib/python3.12/dist-packages (2025.11.12)\n",
            "\u001b[33mWARNING: yt-dlp 2025.11.12 does not provide the extra 'all'\u001b[0m\u001b[33m\n",
            "\u001b[0mCollecting git+https://github.com/openai/whisper.git\n",
            "  Cloning https://github.com/openai/whisper.git to /tmp/pip-req-build-8ho9dumj\n",
            "  Running command git clone --filter=blob:none --quiet https://github.com/openai/whisper.git /tmp/pip-req-build-8ho9dumj\n",
            "  Resolved https://github.com/openai/whisper.git to commit c0d2f624c09dc18e709e37c2ad90c039a4eb72a2\n",
            "  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n",
            "  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n",
            "  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n",
            "Requirement already satisfied: more-itertools in /usr/local/lib/python3.12/dist-packages (from openai-whisper==20250625) (10.8.0)\n",
            "Requirement already satisfied: numba in /usr/local/lib/python3.12/dist-packages (from openai-whisper==20250625) (0.60.0)\n",
            "Requirement already satisfied: numpy in /usr/local/lib/python3.12/dist-packages (from openai-whisper==20250625) (2.0.2)\n",
            "Requirement already satisfied: tiktoken in /usr/local/lib/python3.12/dist-packages (from openai-whisper==20250625) (0.12.0)\n",
            "Requirement already satisfied: torch in /usr/local/lib/python3.12/dist-packages (from openai-whisper==20250625) (2.9.0+cu126)\n",
            "Requirement already satisfied: tqdm in /usr/local/lib/python3.12/dist-packages (from openai-whisper==20250625) (4.67.1)\n",
            "Requirement already satisfied: triton>=2 in /usr/local/lib/python3.12/dist-packages (from openai-whisper==20250625) (3.5.0)\n",
            "Requirement already satisfied: llvmlite<0.44,>=0.43.0dev0 in /usr/local/lib/python3.12/dist-packages (from numba->openai-whisper==20250625) (0.43.0)\n",
            "Requirement already satisfied: regex>=2022.1.18 in /usr/local/lib/python3.12/dist-packages (from tiktoken->openai-whisper==20250625) (2024.11.6)\n",
            "Requirement already satisfied: requests>=2.26.0 in /usr/local/lib/python3.12/dist-packages (from tiktoken->openai-whisper==20250625) (2.32.4)\n",
            "Requirement already satisfied: filelock in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (3.20.0)\n",
            "Requirement already satisfied: typing-extensions>=4.10.0 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (4.15.0)\n",
            "Requirement already satisfied: setuptools in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (75.2.0)\n",
            "Requirement already satisfied: sympy>=1.13.3 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (1.13.3)\n",
            "Requirement already satisfied: networkx>=2.5.1 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (3.5)\n",
            "Requirement already satisfied: jinja2 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (3.1.6)\n",
            "Requirement already satisfied: fsspec>=0.8.5 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (2025.3.0)\n",
            "Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.6.77 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (12.6.77)\n",
            "Requirement already satisfied: nvidia-cuda-runtime-cu12==12.6.77 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (12.6.77)\n",
            "Requirement already satisfied: nvidia-cuda-cupti-cu12==12.6.80 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (12.6.80)\n",
            "Requirement already satisfied: nvidia-cudnn-cu12==9.10.2.21 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (9.10.2.21)\n",
            "Requirement already satisfied: nvidia-cublas-cu12==12.6.4.1 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (12.6.4.1)\n",
            "Requirement already satisfied: nvidia-cufft-cu12==11.3.0.4 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (11.3.0.4)\n",
            "Requirement already satisfied: nvidia-curand-cu12==10.3.7.77 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (10.3.7.77)\n",
            "Requirement already satisfied: nvidia-cusolver-cu12==11.7.1.2 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (11.7.1.2)\n",
            "Requirement already satisfied: nvidia-cusparse-cu12==12.5.4.2 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (12.5.4.2)\n",
            "Requirement already satisfied: nvidia-cusparselt-cu12==0.7.1 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (0.7.1)\n",
            "Requirement already satisfied: nvidia-nccl-cu12==2.27.5 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (2.27.5)\n",
            "Requirement already satisfied: nvidia-nvshmem-cu12==3.3.20 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (3.3.20)\n",
            "Requirement already satisfied: nvidia-nvtx-cu12==12.6.77 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (12.6.77)\n",
            "Requirement already satisfied: nvidia-nvjitlink-cu12==12.6.85 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (12.6.85)\n",
            "Requirement already satisfied: nvidia-cufile-cu12==1.11.1.6 in /usr/local/lib/python3.12/dist-packages (from torch->openai-whisper==20250625) (1.11.1.6)\n",
            "Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.12/dist-packages (from requests>=2.26.0->tiktoken->openai-whisper==20250625) (3.4.4)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.12/dist-packages (from requests>=2.26.0->tiktoken->openai-whisper==20250625) (3.11)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests>=2.26.0->tiktoken->openai-whisper==20250625) (2.5.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests>=2.26.0->tiktoken->openai-whisper==20250625) (2025.11.12)\n",
            "Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.12/dist-packages (from sympy>=1.13.3->torch->openai-whisper==20250625) (1.3.0)\n",
            "Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.12/dist-packages (from jinja2->torch->openai-whisper==20250625) (3.0.3)\n",
            "Requirement already satisfied: moviepy in /usr/local/lib/python3.12/dist-packages (1.0.3)\n",
            "Requirement already satisfied: decorator<5.0,>=4.0.2 in /usr/local/lib/python3.12/dist-packages (from moviepy) (4.4.2)\n",
            "Requirement already satisfied: tqdm<5.0,>=4.11.2 in /usr/local/lib/python3.12/dist-packages (from moviepy) (4.67.1)\n",
            "Requirement already satisfied: requests<3.0,>=2.8.1 in /usr/local/lib/python3.12/dist-packages (from moviepy) (2.32.4)\n",
            "Requirement already satisfied: proglog<=1.0.0 in /usr/local/lib/python3.12/dist-packages (from moviepy) (0.1.12)\n",
            "Requirement already satisfied: numpy>=1.17.3 in /usr/local/lib/python3.12/dist-packages (from moviepy) (2.0.2)\n",
            "Requirement already satisfied: imageio<3.0,>=2.5 in /usr/local/lib/python3.12/dist-packages (from moviepy) (2.37.2)\n",
            "Requirement already satisfied: imageio-ffmpeg>=0.2.0 in /usr/local/lib/python3.12/dist-packages (from moviepy) (0.6.0)\n",
            "Requirement already satisfied: pillow>=8.3.2 in /usr/local/lib/python3.12/dist-packages (from imageio<3.0,>=2.5->moviepy) (11.3.0)\n",
            "Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.12/dist-packages (from requests<3.0,>=2.8.1->moviepy) (3.4.4)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.12/dist-packages (from requests<3.0,>=2.8.1->moviepy) (3.11)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests<3.0,>=2.8.1->moviepy) (2.5.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests<3.0,>=2.8.1->moviepy) (2025.11.12)\n",
            "Requirement already satisfied: tensorflow in /usr/local/lib/python3.12/dist-packages (2.19.0)\n",
            "Requirement already satisfied: absl-py>=1.0.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (1.4.0)\n",
            "Requirement already satisfied: astunparse>=1.6.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (1.6.3)\n",
            "Requirement already satisfied: flatbuffers>=24.3.25 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (25.9.23)\n",
            "Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (0.6.0)\n",
            "Requirement already satisfied: google-pasta>=0.1.1 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (0.2.0)\n",
            "Requirement already satisfied: libclang>=13.0.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (18.1.1)\n",
            "Requirement already satisfied: opt-einsum>=2.3.2 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (3.4.0)\n",
            "Requirement already satisfied: packaging in /usr/local/lib/python3.12/dist-packages (from tensorflow) (25.0)\n",
            "Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<6.0.0dev,>=3.20.3 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (5.29.5)\n",
            "Requirement already satisfied: requests<3,>=2.21.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (2.32.4)\n",
            "Requirement already satisfied: setuptools in /usr/local/lib/python3.12/dist-packages (from tensorflow) (75.2.0)\n",
            "Requirement already satisfied: six>=1.12.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (1.17.0)\n",
            "Requirement already satisfied: termcolor>=1.1.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (3.2.0)\n",
            "Requirement already satisfied: typing-extensions>=3.6.6 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (4.15.0)\n",
            "Requirement already satisfied: wrapt>=1.11.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (2.0.1)\n",
            "Requirement already satisfied: grpcio<2.0,>=1.24.3 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (1.76.0)\n",
            "Requirement already satisfied: tensorboard~=2.19.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (2.19.0)\n",
            "Requirement already satisfied: keras>=3.5.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (3.10.0)\n",
            "Requirement already satisfied: numpy<2.2.0,>=1.26.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (2.0.2)\n",
            "Requirement already satisfied: h5py>=3.11.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (3.15.1)\n",
            "Requirement already satisfied: ml-dtypes<1.0.0,>=0.5.1 in /usr/local/lib/python3.12/dist-packages (from tensorflow) (0.5.4)\n",
            "Requirement already satisfied: wheel<1.0,>=0.23.0 in /usr/local/lib/python3.12/dist-packages (from astunparse>=1.6.0->tensorflow) (0.45.1)\n",
            "Requirement already satisfied: rich in /usr/local/lib/python3.12/dist-packages (from keras>=3.5.0->tensorflow) (13.9.4)\n",
            "Requirement already satisfied: namex in /usr/local/lib/python3.12/dist-packages (from keras>=3.5.0->tensorflow) (0.1.0)\n",
            "Requirement already satisfied: optree in /usr/local/lib/python3.12/dist-packages (from keras>=3.5.0->tensorflow) (0.18.0)\n",
            "Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.21.0->tensorflow) (3.4.4)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.21.0->tensorflow) (3.11)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.21.0->tensorflow) (2.5.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.21.0->tensorflow) (2025.11.12)\n",
            "Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.12/dist-packages (from tensorboard~=2.19.0->tensorflow) (3.10)\n",
            "Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /usr/local/lib/python3.12/dist-packages (from tensorboard~=2.19.0->tensorflow) (0.7.2)\n",
            "Requirement already satisfied: werkzeug>=1.0.1 in /usr/local/lib/python3.12/dist-packages (from tensorboard~=2.19.0->tensorflow) (3.1.3)\n",
            "Requirement already satisfied: MarkupSafe>=2.1.1 in /usr/local/lib/python3.12/dist-packages (from werkzeug>=1.0.1->tensorboard~=2.19.0->tensorflow) (3.0.3)\n",
            "Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.12/dist-packages (from rich->keras>=3.5.0->tensorflow) (4.0.0)\n",
            "Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.12/dist-packages (from rich->keras>=3.5.0->tensorflow) (2.19.2)\n",
            "Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.12/dist-packages (from markdown-it-py>=2.2.0->rich->keras>=3.5.0->tensorflow) (0.1.2)\n",
            "Requirement already satisfied: tensorflow-hub in /usr/local/lib/python3.12/dist-packages (0.16.1)\n",
            "Requirement already satisfied: numpy>=1.12.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow-hub) (2.0.2)\n",
            "Requirement already satisfied: protobuf>=3.19.6 in /usr/local/lib/python3.12/dist-packages (from tensorflow-hub) (5.29.5)\n",
            "Requirement already satisfied: tf-keras>=2.14.1 in /usr/local/lib/python3.12/dist-packages (from tensorflow-hub) (2.19.0)\n",
            "Requirement already satisfied: tensorflow<2.20,>=2.19 in /usr/local/lib/python3.12/dist-packages (from tf-keras>=2.14.1->tensorflow-hub) (2.19.0)\n",
            "Requirement already satisfied: absl-py>=1.0.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (1.4.0)\n",
            "Requirement already satisfied: astunparse>=1.6.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (1.6.3)\n",
            "Requirement already satisfied: flatbuffers>=24.3.25 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (25.9.23)\n",
            "Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (0.6.0)\n",
            "Requirement already satisfied: google-pasta>=0.1.1 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (0.2.0)\n",
            "Requirement already satisfied: libclang>=13.0.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (18.1.1)\n",
            "Requirement already satisfied: opt-einsum>=2.3.2 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (3.4.0)\n",
            "Requirement already satisfied: packaging in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (25.0)\n",
            "Requirement already satisfied: requests<3,>=2.21.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (2.32.4)\n",
            "Requirement already satisfied: setuptools in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (75.2.0)\n",
            "Requirement already satisfied: six>=1.12.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (1.17.0)\n",
            "Requirement already satisfied: termcolor>=1.1.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (3.2.0)\n",
            "Requirement already satisfied: typing-extensions>=3.6.6 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (4.15.0)\n",
            "Requirement already satisfied: wrapt>=1.11.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (2.0.1)\n",
            "Requirement already satisfied: grpcio<2.0,>=1.24.3 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (1.76.0)\n",
            "Requirement already satisfied: tensorboard~=2.19.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (2.19.0)\n",
            "Requirement already satisfied: keras>=3.5.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (3.10.0)\n",
            "Requirement already satisfied: h5py>=3.11.0 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (3.15.1)\n",
            "Requirement already satisfied: ml-dtypes<1.0.0,>=0.5.1 in /usr/local/lib/python3.12/dist-packages (from tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (0.5.4)\n",
            "Requirement already satisfied: wheel<1.0,>=0.23.0 in /usr/local/lib/python3.12/dist-packages (from astunparse>=1.6.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (0.45.1)\n",
            "Requirement already satisfied: rich in /usr/local/lib/python3.12/dist-packages (from keras>=3.5.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (13.9.4)\n",
            "Requirement already satisfied: namex in /usr/local/lib/python3.12/dist-packages (from keras>=3.5.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (0.1.0)\n",
            "Requirement already satisfied: optree in /usr/local/lib/python3.12/dist-packages (from keras>=3.5.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (0.18.0)\n",
            "Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.21.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (3.4.4)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.21.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (3.11)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.21.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (2.5.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.21.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (2025.11.12)\n",
            "Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.12/dist-packages (from tensorboard~=2.19.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (3.10)\n",
            "Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /usr/local/lib/python3.12/dist-packages (from tensorboard~=2.19.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (0.7.2)\n",
            "Requirement already satisfied: werkzeug>=1.0.1 in /usr/local/lib/python3.12/dist-packages (from tensorboard~=2.19.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (3.1.3)\n",
            "Requirement already satisfied: MarkupSafe>=2.1.1 in /usr/local/lib/python3.12/dist-packages (from werkzeug>=1.0.1->tensorboard~=2.19.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (3.0.3)\n",
            "Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.12/dist-packages (from rich->keras>=3.5.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (4.0.0)\n",
            "Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.12/dist-packages (from rich->keras>=3.5.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (2.19.2)\n",
            "Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.12/dist-packages (from markdown-it-py>=2.2.0->rich->keras>=3.5.0->tensorflow<2.20,>=2.19->tf-keras>=2.14.1->tensorflow-hub) (0.1.2)\n",
            "Requirement already satisfied: soundfile in /usr/local/lib/python3.12/dist-packages (0.13.1)\n",
            "Requirement already satisfied: cffi>=1.0 in /usr/local/lib/python3.12/dist-packages (from soundfile) (2.0.0)\n",
            "Requirement already satisfied: numpy in /usr/local/lib/python3.12/dist-packages (from soundfile) (2.0.2)\n",
            "Requirement already satisfied: pycparser in /usr/local/lib/python3.12/dist-packages (from cffi>=1.0->soundfile) (2.23)\n",
            "Requirement already satisfied: librosa in /usr/local/lib/python3.12/dist-packages (0.11.0)\n",
            "Requirement already satisfied: audioread>=2.1.9 in /usr/local/lib/python3.12/dist-packages (from librosa) (3.1.0)\n",
            "Requirement already satisfied: numba>=0.51.0 in /usr/local/lib/python3.12/dist-packages (from librosa) (0.60.0)\n",
            "Requirement already satisfied: numpy>=1.22.3 in /usr/local/lib/python3.12/dist-packages (from librosa) (2.0.2)\n",
            "Requirement already satisfied: scipy>=1.6.0 in /usr/local/lib/python3.12/dist-packages (from librosa) (1.16.3)\n",
            "Requirement already satisfied: scikit-learn>=1.1.0 in /usr/local/lib/python3.12/dist-packages (from librosa) (1.6.1)\n",
            "Requirement already satisfied: joblib>=1.0 in /usr/local/lib/python3.12/dist-packages (from librosa) (1.5.2)\n",
            "Requirement already satisfied: decorator>=4.3.0 in /usr/local/lib/python3.12/dist-packages (from librosa) (4.4.2)\n",
            "Requirement already satisfied: soundfile>=0.12.1 in /usr/local/lib/python3.12/dist-packages (from librosa) (0.13.1)\n",
            "Requirement already satisfied: pooch>=1.1 in /usr/local/lib/python3.12/dist-packages (from librosa) (1.8.2)\n",
            "Requirement already satisfied: soxr>=0.3.2 in /usr/local/lib/python3.12/dist-packages (from librosa) (1.0.0)\n",
            "Requirement already satisfied: typing_extensions>=4.1.1 in /usr/local/lib/python3.12/dist-packages (from librosa) (4.15.0)\n",
            "Requirement already satisfied: lazy_loader>=0.1 in /usr/local/lib/python3.12/dist-packages (from librosa) (0.4)\n",
            "Requirement already satisfied: msgpack>=1.0 in /usr/local/lib/python3.12/dist-packages (from librosa) (1.1.2)\n",
            "Requirement already satisfied: packaging in /usr/local/lib/python3.12/dist-packages (from lazy_loader>=0.1->librosa) (25.0)\n",
            "Requirement already satisfied: llvmlite<0.44,>=0.43.0dev0 in /usr/local/lib/python3.12/dist-packages (from numba>=0.51.0->librosa) (0.43.0)\n",
            "Requirement already satisfied: platformdirs>=2.5.0 in /usr/local/lib/python3.12/dist-packages (from pooch>=1.1->librosa) (4.5.0)\n",
            "Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.12/dist-packages (from pooch>=1.1->librosa) (2.32.4)\n",
            "Requirement already satisfied: threadpoolctl>=3.1.0 in /usr/local/lib/python3.12/dist-packages (from scikit-learn>=1.1.0->librosa) (3.6.0)\n",
            "Requirement already satisfied: cffi>=1.0 in /usr/local/lib/python3.12/dist-packages (from soundfile>=0.12.1->librosa) (2.0.0)\n",
            "Requirement already satisfied: pycparser in /usr/local/lib/python3.12/dist-packages (from cffi>=1.0->soundfile>=0.12.1->librosa) (2.23)\n",
            "Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.12/dist-packages (from requests>=2.19.0->pooch>=1.1->librosa) (3.4.4)\n",
            "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.12/dist-packages (from requests>=2.19.0->pooch>=1.1->librosa) (3.11)\n",
            "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests>=2.19.0->pooch>=1.1->librosa) (2.5.0)\n",
            "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests>=2.19.0->pooch>=1.1->librosa) (2025.11.12)\n"
          ]
        }
      ],
      "source": [
        "\n",
        "# Instalasi pustaka penuh untuk menghindari error\n",
        "!pip install yt-dlp[all]\n",
        "!pip install --upgrade --no-cache-dir git+https://github.com/openai/whisper.git\n",
        "!pip install moviepy\n",
        "\n",
        "# --- PENAMBAHAN UNTUK DETEKSI SUARA (AEC/YAMNet) ---\n",
        "!pip install tensorflow\n",
        "!pip install tensorflow-hub\n",
        "!pip install soundfile # Untuk membaca dan memproses file audio\n",
        "!pip install librosa    # Alat bantu untuk pemrosesan sinyal audio"
      ]
    },
    {
      "cell_type": "code",
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "collapsed": true,
        "id": "IuioASJ5NN_u",
        "outputId": "780c92fc-61ad-4546-b080-eca6d7b0da54"
      },
      "source": [
        "\n",
        "### SEL 3: Download Video YouTube (KODE FINAL DENGAN LOGIKA KONDISIONAL) ###\n",
        "import yt_dlp\n",
        "import os\n",
        "import re\n",
        "from pathlib import Path\n",
        "\n",
        "# --- FUNGSI PEMBANTU ---\n",
        "def is_youtube_url(text):\n",
        "    \"\"\"Cek apakah string input terlihat seperti Tautan YouTube.\"\"\"\n",
        "    # Pola regex sederhana untuk mendeteksi domain YouTube atau youtu.be\n",
        "    youtube_pattern = r'(https?:\\/\\/(www\\.)?(youtube\\.com|youtu\\.be)\\/)'\n",
        "    return re.search(youtube_pattern, text, re.IGNORECASE) is not None\n",
        "# -----------------------\n",
        "\n",
        "# =======================================================\n",
        "# ‚î°‚î° INPUT PERTAMA & KONDISI\n",
        "# =======================================================\n",
        "# Meminta satu input, yang bisa berupa Tautan atau Nama File\n",
        "INITIAL_INPUT = input(\"Masukkan Tautan YouTube LENGKAP untuk diunduh, ATAU Nama File yang sudah ada (Contoh: https://youtu.be/... atau video001): \")\n",
        "\n",
        "# --- LOGIKA KONDISIONAL ---\n",
        "if is_youtube_url(INITIAL_INPUT):\n",
        "    # KASUS 1: Input adalah Tautan YouTube\n",
        "    YOUTUBE_URL = INITIAL_INPUT\n",
        "\n",
        "    # Minta nama file output\n",
        "    BASE_FILENAME = input(\"‚úÖ Input dikenali sebagai Tautan YouTube. Masukkan Nama File Video Output (Contoh: video001): \")\n",
        "    DOWNLOAD_REQUIRED = True\n",
        "else:\n",
        "    # KASUS 2: Input adalah Nama File\n",
        "    BASE_FILENAME = INITIAL_INPUT\n",
        "    YOUTUBE_URL = None # Tidak ada URL untuk diunduh\n",
        "    DOWNLOAD_REQUIRED = False\n",
        "    print(f\"‚úÖ Input dikenali sebagai Nama File '{BASE_FILENAME}'. Proses unduhan akan dilewati.\")\n",
        "\n",
        "# --- KONFIGURASI PATH ---\n",
        "OUTPUT_FILENAME = f\"{BASE_FILENAME}.mp4\"\n",
        "DRIVE_PATH = '/content/drive/MyDrive/VideoProjects'\n",
        "FULL_OUTPUT_PATH = os.path.join(DRIVE_PATH, OUTPUT_FILENAME)\n",
        "\n",
        "# Pastikan folder output ada\n",
        "os.makedirs(DRIVE_PATH, exist_ok=True)\n",
        "\n",
        "# ------------------------------------------------------\n",
        "# --- PROSES UTAMA: UNDUHAN (KONDISIONAL) ---\n",
        "# ------------------------------------------------------\n",
        "\n",
        "if DOWNLOAD_REQUIRED:\n",
        "    ydl_opts = {\n",
        "        'format': 'bestvideo[ext=mp4]+bestaudio[ext=m4a]/best[ext=mp4]/best',\n",
        "        'outtmpl': FULL_OUTPUT_PATH,\n",
        "        'quiet': False,\n",
        "        'verbose': True,\n",
        "        'noplaylist': True,\n",
        "        'geo_bypass': True,\n",
        "        'no_warnings': True,\n",
        "        'retries': 5,\n",
        "        'http_headers': {\n",
        "            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36',\n",
        "            'Accept-Language': 'en-US,en;q=0.9',\n",
        "        },\n",
        "    }\n",
        "\n",
        "    print(f\"\\n--- PROSES UNDUHAN DIMULAI ---\")\n",
        "    print(f\"Mengunduh video dari {YOUTUBE_URL} ke: {FULL_OUTPUT_PATH}...\")\n",
        "    print(\"Opsi yt-dlp yang digunakan:\", ydl_opts)\n",
        "\n",
        "    try:\n",
        "        if not YOUTUBE_URL:\n",
        "            # Pengecekan keamanan tambahan, seharusnya sudah ditangani logika di atas\n",
        "            raise ValueError(\"Tautan YouTube tidak boleh kosong.\")\n",
        "\n",
        "        with yt_dlp.YoutubeDL(ydl_opts) as ydl:\n",
        "            ydl.download([YOUTUBE_URL])\n",
        "        print(\"Download Selesai.\")\n",
        "    except ValueError as ve:\n",
        "        print(f\"ERROR: {ve}\")\n",
        "    except Exception as e:\n",
        "        print(f\"ERROR saat mengunduh: {e}\")\n",
        "\n",
        "else:\n",
        "    # Jika tidak ada unduhan (menggunakan file yang sudah ada)\n",
        "    # Cek apakah file yang diasumsikan memang ada\n",
        "    if not Path(FULL_OUTPUT_PATH).is_file():\n",
        "         print(f\"‚ö†Ô∏è PERINGATAN: File yang diasumsikan '{OUTPUT_FILENAME}' TIDAK ditemukan di {DRIVE_PATH}.\")\n",
        "         print(\"Pastikan Anda sudah mengunggah file tersebut atau coba lagi dengan tautan YouTube.\")\n",
        "\n",
        "    print(f\"\\n--- PROSES UNDUHAN DILEWATI ---\")\n",
        "    print(f\"Diasumsikan file input Anda adalah: {FULL_OUTPUT_PATH}\")\n",
        "    print(\"Anda dapat melanjutkan ke sel berikutnya untuk Transkripsi.\")\n",
        "\n",
        "# Pastikan BASE_FILENAME tersedia untuk sel berikutnya\n",
        "print(f\"\\nBASE_FILENAME yang akan digunakan pada sel berikutnya: {BASE_FILENAME}\")"
      ],
      "execution_count": 16,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Masukkan Tautan YouTube LENGKAP untuk diunduh, ATAU Nama File yang sudah ada (Contoh: https://youtu.be/... atau video001): muhasabah\n",
            "‚úÖ Input dikenali sebagai Nama File 'muhasabah'. Proses unduhan akan dilewati.\n",
            "\n",
            "--- PROSES UNDUHAN DILEWATI ---\n",
            "Diasumsikan file input Anda adalah: /content/drive/MyDrive/VideoProjects/muhasabah.mp4\n",
            "Anda dapat melanjutkan ke sel berikutnya untuk Transkripsi.\n",
            "\n",
            "BASE_FILENAME yang akan digunakan pada sel berikutnya: muhasabah\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 17,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "eenmdrvTNQ5O",
        "outputId": "941b5bf3-f81e-49a2-cb5e-584edde831f5"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Memulai Transkripsi video 'muhasabah.mp4' di perangkat: cpu...\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "/usr/local/lib/python3.12/dist-packages/whisper/transcribe.py:132: UserWarning: FP16 is not supported on CPU; using FP32 instead\n",
            "  warnings.warn(\"FP16 is not supported on CPU; using FP32 instead\")\n"
          ]
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "‚úÖ Transkrip lengkap (.txt) disimpan di: /content/drive/MyDrive/VideoProjects/muhasabah_transkrip.txt\n",
            "Transkripsi Selesai. Ditemukan 100 segmen.\n"
          ]
        }
      ],
      "source": [
        "\n",
        "### SEL 4: Transkripsi Whisper (KODE FINAL DIPERBAHARUI DENGAN INPUT) ###\n",
        "import whisper\n",
        "import os\n",
        "import torch\n",
        "from pathlib import Path\n",
        "\n",
        "# --- INPUT PENTING: MINTA NAMA FILE DARI PENGGUNA ---\n",
        "# Minta nama file video input yang sudah diunduh.\n",
        "# Kami akan mengasumsikan ekstensinya adalah .mp4\n",
        "\n",
        "TRANSCRIPT_FILENAME = f\"{BASE_FILENAME}_transkrip.txt\"\n",
        "# -----------------------------------------------------\n",
        "\n",
        "# PASTIKAN FOLDER 'VideoProjects' sudah ada atau buat folder ini di Drive Anda!\n",
        "DRIVE_PATH = '/content/drive/MyDrive/VideoProjects'\n",
        "FULL_OUTPUT_PATH = os.path.join(DRIVE_PATH, OUTPUT_FILENAME)\n",
        "TRANSCRIPT_PATH = os.path.join(DRIVE_PATH, TRANSCRIPT_FILENAME)\n",
        "\n",
        "# Cek apakah file video input ada sebelum memulai transkripsi\n",
        "if not Path(FULL_OUTPUT_PATH).is_file():\n",
        "    print(f\"‚ùå ERROR: File video tidak ditemukan di: {FULL_OUTPUT_PATH}\")\n",
        "    print(\"Pastikan Anda sudah menjalankan Sel 3 (Download) atau nama file sudah benar.\")\n",
        "    # Menghentikan skrip jika file tidak ditemukan\n",
        "    #exit()\n",
        "\n",
        "# Pilih model Whisper dan perangkat (device) yang akan digunakan (GPU/CPU)\n",
        "device = \"cuda\" if torch.cuda.is_available() else \"cpu\"\n",
        "# Memuat model 'base' atau ganti ke model yang lebih besar ('medium', 'large') jika diperlukan\n",
        "try:\n",
        "    model = whisper.load_model(\"base\", device=device)\n",
        "except Exception as e:\n",
        "    print(f\"‚ùå Gagal memuat model Whisper: {e}\")\n",
        "    #exit()\n",
        "\n",
        "print(f\"Memulai Transkripsi video '{OUTPUT_FILENAME}' di perangkat: {device}...\")\n",
        "try:\n",
        "    # Lakukan transkripsi\n",
        "    result = model.transcribe(FULL_OUTPUT_PATH)\n",
        "    segments = result['segments']\n",
        "\n",
        "    # üî• BAGIAN BARU: Menyimpan Teks Transkrip Lengkap\n",
        "    with open(TRANSCRIPT_PATH, 'w', encoding='utf-8') as f:\n",
        "        f.write(result['text'])\n",
        "    print(f\"‚úÖ Transkrip lengkap (.txt) disimpan di: {TRANSCRIPT_PATH}\")\n",
        "\n",
        "    print(f\"Transkripsi Selesai. Ditemukan {len(segments)} segmen.\")\n",
        "\n",
        "except FileNotFoundError:\n",
        "    print(f\"‚ùå ERROR: File video tidak ditemukan. Transkripsi dibatalkan.\")\n",
        "except Exception as e:\n",
        "    print(f\"‚ùå ERROR saat transkripsi: {e}\")"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "### SEL 5: Membuat File Subtitle ASS (Efek Karaoke + Transkrip Mentah) ###\n",
        "import os\n",
        "import re\n",
        "\n",
        "# Asumsi segments sudah ada dari SEL 4\n",
        "\n",
        "STYLE_DEFINITION = (\n",
        "    # ... (STYLE_DEFINITION tetap sama) ...\n",
        "    \"[V4+ Styles]\\n\"\n",
        "    \"Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Shadow, Outline, Alignment, MarginL, MarginR, MarginV, Encoding\\n\"\n",
        "    f\"Style: Default,Tahoma,30,&H00FFFFFF,&H00000000,&H00000000,&H00000000,-1,0,1,2,2,20,20,20,1\\n\"\n",
        ")\n",
        "\n",
        "def create_ass_file(segments, output_path, style_def):\n",
        "    \"\"\"Membuat file ASS dari segmen Whisper dengan efek karaoke word-level.\"\"\"\n",
        "    def to_ass_time(seconds):\n",
        "        h = int(seconds // 3600)\n",
        "        m = int((seconds % 3600) // 60)\n",
        "        s = int(seconds % 60)\n",
        "        cs = int((seconds * 100) % 100)\n",
        "        return f\"{h}:{m:02d}:{s:02d}.{cs:02d}\"\n",
        "\n",
        "    # üî• KODE BARU: Mengambil Transkrip Penuh\n",
        "    full_transcript = \"\\n\".join([seg['text'].strip() for seg in segments])\n",
        "\n",
        "    ass_content = \"[Script Info]\\nTitle: Generated Subtitles\\nScriptType: v4.00+\\nWrapStyle: 0\\nScaledBorderAndShadow: yes\\nYCbCr Matrix: None\\n\"\n",
        "    # üî• MENAMBAHKAN TRANSKRIP SEBAGAI KOMENTAR (Koma dihilangkan agar valid)\n",
        "    ass_content += f\"; Full Transcript:\\n; {full_transcript.replace(',', '')}\\n\\n\"\n",
        "\n",
        "    ass_content += style_def\n",
        "    ass_content += \"\\n[Events]\\nFormat: Layer, Start, End, Style, Actor, MarginL, MarginR, MarginV, Effect, Text\\n\"\n",
        "\n",
        "    for segment in segments:\n",
        "        start_time_ass = to_ass_time(segment['start'])\n",
        "        end_time_ass = to_ass_time(segment['end'])\n",
        "\n",
        "        karaoke_text = \"\"\n",
        "\n",
        "        if 'words' in segment and segment['words']:\n",
        "            for word_data in segment['words']:\n",
        "                word = word_data['word'].strip()\n",
        "                if not word: continue\n",
        "\n",
        "                duration_seconds = word_data['end'] - word_data['start']\n",
        "                duration_centiseconds = int(duration_seconds * 100)\n",
        "\n",
        "                karaoke_text += f'{{\\\\k{duration_centiseconds}}}{word} '\n",
        "\n",
        "            karaoke_text = karaoke_text.strip()\n",
        "\n",
        "        else:\n",
        "            karaoke_text = re.sub(r'[\\r\\n]', ' ', segment['text'].strip())\n",
        "\n",
        "        # Baris Dialogue ASS\n",
        "        ass_content += f\"Dialogue: 0,{start_time_ass},{end_time_ass},Default,,0,0,0,,{karaoke_text}\\n\"\n",
        "\n",
        "    with open(output_path, 'w', encoding='utf-8') as f:\n",
        "        f.write(ass_content)\n",
        "\n",
        "# Buat file ASS global (asumsi segments sudah ada dari SEL 4)\n",
        "ASS_PATH = os.path.join('/content/', 'video_subtitles.ass')\n",
        "create_ass_file(segments, ASS_PATH, STYLE_DEFINITION)\n",
        "\n",
        "print(f\"File subtitle ASS dengan efek karaoke word-level berhasil dibuat di: {ASS_PATH}\")"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Tc7-28EFCaYV",
        "outputId": "4e45b05f-c213-45cb-83ba-c707647a4225"
      },
      "execution_count": 18,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "File subtitle ASS dengan efek karaoke word-level berhasil dibuat di: /content/video_subtitles.ass\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 19,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "sfPB7rFsNTPu",
        "outputId": "84f77c33-624f-4aa2-e4de-6b925c2668fd",
        "collapsed": true
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Total Segmen Awal (Whisper): 100\n",
            "Total Klip Video Koheren yang Akan Dibuat: 6\n",
            "Memotong dan membakar subtitle dengan FFmpeg...\n",
            "Klip akan disimpan di: /content/drive/MyDrive/VideoProjects/Klip_Keluaran_Koheren\n",
            "Klip 1 (39.00s): Selesai disimpan sebagai: 01_Berupaya_lah_selalu_untuk_menghadirkan_amal_soal_eh_dalam_setiap_APPLAUSE_LAUGHTER_SCREAM.mp4\n",
            "Klip 2 (50.00s): Selesai disimpan sebagai: 02_Tiga_awas_ini_belum_salah_saya_kesimpulannya_Tidak_ada_manusia.mp4\n",
            "Klip 3 (13.00s): Selesai disimpan sebagai: 03_Betul_dan_itu_Allah_sangat_mencintai_Allah_sangat_mencintai_pelaku.mp4\n",
            "Klip 4 (76.00s): Selesai disimpan sebagai: 04_Allah_sangat_mencintai_pelaku_maaf_siat_yang_gemar_bertulbat_dibandingkan.mp4\n",
            "Klip 5 (13.00s): Selesai disimpan sebagai: 05_Salah_sama_ibu_sama_bapak_belum_minta_maaf_sudah_meninggal.mp4\n",
            "Klip 6 (163.00s): Selesai disimpan sebagai: 06_Jangan_nyalan_guru_Guru_gak_salah_Antum_tolong_nyawa_saya.mp4\n",
            "\n",
            "Semua klip koheren dengan subtitle tersimpan di: /content/drive/MyDrive/VideoProjects/Klip_Keluaran_Koheren\n"
          ]
        }
      ],
      "source": [
        "### SEL 5/6: Pemotongan Klip Video Koheren (KODE FINAL DENGAN BATAS DURASI) ###\n",
        "import os\n",
        "import re\n",
        "import subprocess\n",
        "from pathlib import Path\n",
        "\n",
        "# --- KONFIGURASI PENGELOMPOKAN ---\n",
        "JEDA_MINIMAL_KLIP_BARU = 1.5   # Jeda (detik) untuk memulai klip baru\n",
        "MAX_CLIP_DURATION = 30.0     # üî• BATAS BARU: Durasi Maksimal per Klip (detik)\n",
        "# --- END KONFIGURASI ---\n",
        "\n",
        "DRIVE_PATH = '/content/drive/MyDrive/VideoProjects'\n",
        "\n",
        "# ------------------------------------------------------------------\n",
        "# üî• KOREKSI PATH: Menggunakan variabel global dari Sel 3 dan Sel 4\n",
        "# Asumsi: BASE_FILENAME tersedia dari Sel 3, ASS_PATH tersedia dari Sel 8\n",
        "# ------------------------------------------------------------------\n",
        "OUTPUT_FILENAME = f\"{BASE_FILENAME}.mp4\"\n",
        "FULL_VIDEO_PATH_IN_DRIVE = os.path.join(DRIVE_PATH, OUTPUT_FILENAME)\n",
        "INPUT_VIDEO = FULL_VIDEO_PATH_IN_DRIVE\n",
        "# ASS_PATH diasumsikan tersedia dari Sel 8\n",
        "\n",
        "# --- DATA DARI MODEL AEC (Placeholder) ---\n",
        "DETECTED_EVENTS = [\n",
        "    {'label': 'Laughter', 'start': 4.0, 'end': 6.0},\n",
        "    {'label': 'Scream', 'start': 9.5, 'end': 10.5},\n",
        "    {'label': 'Applause', 'start': 15.0, 'end': 17.0}\n",
        "]\n",
        "\n",
        "CLIPS_FOLDER = os.path.join(DRIVE_PATH, 'Klip_Keluaran_Koheren')\n",
        "os.makedirs(CLIPS_FOLDER, exist_ok=True)\n",
        "\n",
        "\n",
        "# ------------------------------------------------------------------\n",
        "## FUNGSI TAMBAHAN UNTUK INTEGRASI AEC (TETAP SAMA)\n",
        "# ------------------------------------------------------------------\n",
        "def check_for_events(segment_start, segment_end, events_list):\n",
        "    \"\"\"Mengecek apakah segmen video berpotongan dengan waktu peristiwa suara.\"\"\"\n",
        "    flags = []\n",
        "    TARGET_LABELS = ['LAUGHTER', 'SCREAM', 'APPLAUSE', 'CRYING', 'SHOUTING']\n",
        "\n",
        "    for event in events_list:\n",
        "        event_label = event['label'].upper()\n",
        "        if event_label not in TARGET_LABELS: continue\n",
        "\n",
        "        overlap_start = max(segment_start, event['start'])\n",
        "        overlap_end = min(segment_end, event['end'])\n",
        "\n",
        "        if overlap_start < overlap_end:\n",
        "            flags.append(event_label)\n",
        "\n",
        "    return \"_\".join(sorted(list(set(flags))))\n",
        "\n",
        "# ------------------------------------------------------------------\n",
        "## 1. Fungsi Pengelompokan Segmen (DIPERBARUI DENGAN MAX_DURATION)\n",
        "# ------------------------------------------------------------------\n",
        "def group_segments(segments, max_gap, max_duration):\n",
        "    \"\"\"Mengelompokkan segmen pendek menjadi klip video utuh berdasarkan jeda dan batas durasi.\"\"\"\n",
        "    if not segments:\n",
        "        return []\n",
        "\n",
        "    grouped_segments = []\n",
        "    current_group = {\n",
        "        'start': segments[0]['start'],\n",
        "        'end': segments[0]['end'],\n",
        "        'text': segments[0]['text'].strip(),\n",
        "        'words': segments[0].get('words', []),\n",
        "        'original_segments': [segments[0]]\n",
        "    }\n",
        "\n",
        "    for i in range(1, len(segments)):\n",
        "        prev_end = segments[i-1]['end']\n",
        "        current_start = segments[i]['start']\n",
        "        gap = current_start - prev_end\n",
        "\n",
        "        # Hitung durasi POTENSIAL jika segmen saat ini digabungkan\n",
        "        potential_duration = segments[i]['end'] - current_group['start']\n",
        "\n",
        "        # KONDISI PEMECAHAN KLIP:\n",
        "        # 1. Jeda terlalu panjang (gap >= max_gap)\n",
        "        # 2. Durasi akan melebihi batas jika digabungkan (potential_duration > max_duration)\n",
        "\n",
        "        if gap < max_gap and potential_duration <= max_duration:\n",
        "            # Gabungkan segmen: perbarui end time, dan gabungkan teks/words\n",
        "            current_group['end'] = segments[i]['end']\n",
        "            current_group['text'] += ' ' + segments[i]['text'].strip()\n",
        "            current_group['words'].extend(segments[i].get('words', []))\n",
        "            current_group['original_segments'].append(segments[i])\n",
        "        else:\n",
        "            # Jeda panjang ATAU Durasi Melebihi Batas: Klip saat ini selesai\n",
        "            grouped_segments.append(current_group)\n",
        "\n",
        "            # Mulai grup baru dengan segmen [i]\n",
        "            current_group = {\n",
        "                'start': segments[i]['start'],\n",
        "                'end': segments[i]['end'],\n",
        "                'text': segments[i]['text'].strip(),\n",
        "                'words': segments[i].get('words', []),\n",
        "                'original_segments': [segments[i]]\n",
        "            }\n",
        "\n",
        "    # Tambahkan grup terakhir\n",
        "    if current_group:\n",
        "        grouped_segments.append(current_group)\n",
        "\n",
        "    return grouped_segments\n",
        "\n",
        "# ------------------------------------------------------------------\n",
        "## 2. Fungsi Pembersihan Nama File (TETAP SAMA)\n",
        "# ------------------------------------------------------------------\n",
        "def clean_filename(text):\n",
        "    \"\"\"Membersihkan teks agar aman digunakan sebagai nama file.\"\"\"\n",
        "    words = text.split()[:10]\n",
        "    filename = ' '.join(words)\n",
        "    filename = re.sub(r'[^\\w\\s-]', '', filename).strip()\n",
        "    filename = re.sub(r'\\s+', '_', filename)\n",
        "    return filename\n",
        "\n",
        "# ------------------------------------------------------------------\n",
        "# --- PROSES UTAMA ---\n",
        "# ------------------------------------------------------------------\n",
        "# üî• Langkah 1: Pengelompokan Segmen (Menggunakan parameter max_duration BARU)\n",
        "coherent_segments = group_segments(segments, max_gap=JEDA_MINIMAL_KLIP_BARU, max_duration=MAX_CLIP_DURATION)\n",
        "\n",
        "print(f\"Total Segmen Awal (Whisper): {len(segments)}\")\n",
        "print(f\"Batas Durasi Maksimal per Klip: {MAX_CLIP_DURATION} detik\")\n",
        "print(f\"Total Klip Video Koheren yang Akan Dibuat: {len(coherent_segments)}\")\n",
        "print(\"Memotong dan membakar subtitle dengan FFmpeg...\")\n",
        "print(f\"Klip akan disimpan di: {CLIPS_FOLDER}\")\n",
        "\n",
        "# üî• Langkah 2: Iterasi Klip Koheren dan Hardsubbing\n",
        "for i, segment in enumerate(coherent_segments):\n",
        "    start_time = segment['start']\n",
        "    duration = segment['end'] - segment['start']\n",
        "\n",
        "    # --- INTEGRASI AEC BARU ---\n",
        "    event_flags = check_for_events(segment['start'], segment['end'], DETECTED_EVENTS)\n",
        "    # -------------------------\n",
        "\n",
        "    base_name = clean_filename(segment['text'])\n",
        "\n",
        "    if event_flags:\n",
        "        base_name += f'_{event_flags}'\n",
        "\n",
        "    output_clip_name = f'{i+1:02d}_{base_name}.mp4'\n",
        "    output_clip_path = os.path.join(CLIPS_FOLDER, output_clip_name)\n",
        "\n",
        "    # Perintah FFmpeg (TETAP SAMA)\n",
        "    ffmpeg_command = (\n",
        "        f'ffmpeg -y '\n",
        "        f'-i \"{INPUT_VIDEO}\" '\n",
        "        f'-ss {segment[\"start\"]} '\n",
        "        f'-t {duration} '\n",
        "        f'-vf \"subtitles=\\'{ASS_PATH}\\':force_style=\\'Default\\'\" '\n",
        "        f'-c:v libx264 -crf 23 -preset veryfast '\n",
        "        f'-c:a aac -b:a 128k '\n",
        "        f'\"{output_clip_path}\"'\n",
        "    )\n",
        "\n",
        "    # Jalankan perintah menggunakan subprocess.run\n",
        "    try:\n",
        "        subprocess.run(ffmpeg_command, shell=True, check=True, capture_output=True, text=True)\n",
        "        print(f\"Klip {i+1} ({duration:.2f}s): Selesai disimpan sebagai: {output_clip_name}\")\n",
        "    except subprocess.CalledProcessError as e:\n",
        "        print(f\"ERROR FFmpeg Klip {i+1}: {e.stderr}\")\n",
        "\n",
        "print(f\"\\nSemua klip koheren dengan subtitle tersimpan di: {CLIPS_FOLDER}\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 20,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "99-xZDgS1WAp",
        "outputId": "324e846e-e0d3-45a5-eee6-f263eeb66df9",
        "collapsed": true
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "ERROR: Tidak ditemukan file MP4 di folder /content/drive/MyDrive/VideoProjects/Klip_Output. Pastikan Sel 5 berhasil dijalankan.\n",
            "\n",
            "Periksa folder unduhan PC lokal Anda.\n"
          ]
        }
      ],
      "source": [
        "### SEL 6: Download Semua Klip ke PC Lokal ###\n",
        "import os\n",
        "import glob\n",
        "from google.colab import files\n",
        "\n",
        "# Asumsi DRIVE_PATH telah didefinisikan di Sel 1\n",
        "# Sesuaikan nama folder jika Anda mengubahnya di Sel 5\n",
        "CLIPS_FOLDER = os.path.join(DRIVE_PATH, 'Klip_Output')\n",
        "\n",
        "# Mencari semua file MP4 di folder output\n",
        "clips_list = glob.glob(os.path.join(CLIPS_FOLDER, '*.mp4'))\n",
        "\n",
        "if not clips_list:\n",
        "    print(f\"ERROR: Tidak ditemukan file MP4 di folder {CLIPS_FOLDER}. Pastikan Sel 5 berhasil dijalankan.\")\n",
        "else:\n",
        "    print(f\"Memicu download untuk {len(clips_list)} klip video...\")\n",
        "    for clip_path in clips_list:\n",
        "        try:\n",
        "            # Memicu download untuk setiap file\n",
        "            files.download(clip_path)\n",
        "            print(f\"File {os.path.basename(clip_path)} sedang diunduh...\")\n",
        "        except Exception as e:\n",
        "            print(f\"Gagal mengunduh {os.path.basename(clip_path)}: {e}\")\n",
        "\n",
        "print(\"\\nPeriksa folder unduhan PC lokal Anda.\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 21,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "collapsed": true,
        "id": "d82943dd",
        "outputId": "a6f3f9c6-c858-4f02-ddac-10fc660d966c"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Checking for cookies file at: /content/cookies.txt\n",
            "Error: cookies.txt NOT found at the specified path. Please ensure you have uploaded it.\n"
          ]
        }
      ],
      "source": [
        "import os\n",
        "\n",
        "COOKIES_PATH = '/content/cookies.txt'\n",
        "\n",
        "print(f\"Checking for cookies file at: {COOKIES_PATH}\")\n",
        "if os.path.exists(COOKIES_PATH):\n",
        "    print(\"cookies.txt found!\")\n",
        "    with open(COOKIES_PATH, 'r') as f:\n",
        "        content = f.read(100) # Read first 100 chars to check for content\n",
        "        if content:\n",
        "            print(\"File contains content (showing first 100 characters):\")\n",
        "            print(content)\n",
        "        else:\n",
        "            print(\"Warning: cookies.txt is empty.\")\n",
        "else:\n",
        "    print(\"Error: cookies.txt NOT found at the specified path. Please ensure you have uploaded it.\")\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 22,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "collapsed": true,
        "id": "940fe934",
        "outputId": "8dba2e46-b0d7-4494-a76c-4b2cc9ed5c5c"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Reading package lists... Done\n",
            "Building dependency tree... Done\n",
            "Reading state information... Done\n",
            "npm is already the newest version (8.5.1~ds-1).\n",
            "nodejs is already the newest version (12.22.9~dfsg-1ubuntu3.6).\n",
            "0 upgraded, 0 newly installed, 0 to remove and 41 not upgraded.\n"
          ]
        }
      ],
      "source": [
        "# Install Node.js for yt-dlp to handle JavaScript challenges\n",
        "!sudo apt-get install -y nodejs npm"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 23,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "4a10e0bb",
        "outputId": "3a52e87c-cfea-4482-e2de-8e3e30925e8d"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Checking for video file at: /content/drive/MyDrive/VideoProjects/muhasabah\n",
            "Video 'muhasabah' NOT found at the specified path. Please ensure you have uploaded it or provided a working URL.\n"
          ]
        }
      ],
      "source": [
        "import os\n",
        "\n",
        "# Ensure DRIVE_PATH is defined if this cell is run independently\n",
        "DRIVE_PATH = '/content/drive/MyDrive/VideoProjects'\n",
        "OUTPUT_FILENAME = BASE_FILENAME #'muhasabah.mp4'\n",
        "FULL_OUTPUT_PATH = os.path.join(DRIVE_PATH, OUTPUT_FILENAME)\n",
        "\n",
        "print(f\"Checking for video file at: {FULL_OUTPUT_PATH}\")\n",
        "if os.path.exists(FULL_OUTPUT_PATH):\n",
        "    print(f\"Video '{OUTPUT_FILENAME}' found in '{DRIVE_PATH}'!\")\n",
        "else:\n",
        "    print(f\"Video '{OUTPUT_FILENAME}' NOT found at the specified path. Please ensure you have uploaded it or provided a working URL.\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 24,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "425adfc9",
        "outputId": "d5e2c40d-ab87-4dc8-f68d-a26c8c9f16a5"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Checking if openai-whisper is installed...\n",
            "Name: openai-whisper\n",
            "Version: 20250625\n",
            "Summary: Robust Speech Recognition via Large-Scale Weak Supervision\n",
            "Home-page: https://github.com/openai/whisper\n",
            "Author: OpenAI\n",
            "Author-email: \n",
            "License: MIT\n",
            "Location: /usr/local/lib/python3.12/dist-packages\n",
            "Requires: more-itertools, numba, numpy, tiktoken, torch, tqdm, triton\n",
            "Required-by: \n"
          ]
        }
      ],
      "source": [
        "print('Checking if openai-whisper is installed...')\n",
        "!pip show openai-whisper"
      ]
    }
  ],
  "metadata": {
    "colab": {
      "provenance": [],
      "authorship_tag": "ABX9TyMpkAskbDQEHNgVRN+1abv5",
      "include_colab_link": true
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}